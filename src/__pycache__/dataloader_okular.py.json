[{"ast": "Module(body=[FunctionDef(name='load_gt_poses', args=arguments(posonlyargs=[], args=[arg(arg='seq'), arg(arg='home_dir')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='/home/aaron/datasets/OKULAr')]), body=[Assign(targets=[Name(id='path', ctx=Store())], value=Call(func=Name(id='get_path', ctx=Load()), args=[Name(id='seq', ctx=Load()), Name(id='home_dir', ctx=Load())], keywords=[])), Return(value=Call(func=Name(id='_load_gt_poses', ctx=Load()), args=[Name(id='path', ctx=Load())], keywords=[]))], decorator_list=[Call(func=Name(id='persist', ctx=Load()), args=[], keywords=[keyword(arg='depth', value=Constant(value=3)), keyword(arg='verbose', value=Constant(value=True))])])], type_ignores=[])Module(body=[FunctionDef(name='persist', args=arguments(posonlyargs=[], args=[arg(arg='depth'), arg(arg='verbose')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=0), Constant(value=False)]), body=[FunctionDef(name='_persist', args=arguments(posonlyargs=[], args=[arg(arg='func')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='wrapper', args=arguments(posonlyargs=[], args=[], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[]), body=[Assign(targets=[Name(id='function_call', ctx=Store())], value=Call(func=Name(id='Function_Call', ctx=Load()), args=[Name(id='func', ctx=Load()), Name(id='args', ctx=Load()), Name(id='kwargs', ctx=Load()), Constant(value=1)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='success', ctx=Store()), Name(id='persisted_result', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='function_call', ctx=Load()), attr='Load_Results', ctx=Load()), args=[], keywords=[])), If(test=Name(id='success', ctx=Load()), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[JoinedStr(values=[Constant(value='Successfully loaded results for:'), FormattedValue(value=Name(id='func', ctx=Load()), conversion=-1)])], keywords=[])), Return(value=Name(id='persisted_result', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='result', ctx=Store())], value=Call(func=Name(id='func', ctx=Load()), args=[Starred(value=Name(id='args', ctx=Load()), ctx=Load())], keywords=[keyword(value=Name(id='kwargs', ctx=Load()))])), Expr(value=Call(func=Attribute(value=Name(id='function_call', ctx=Load()), attr='Save_Results', ctx=Load()), args=[Name(id='result', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[JoinedStr(values=[Constant(value='Successfully saved results for:'), FormattedValue(value=Name(id='func', ctx=Load()), conversion=-1)])], keywords=[])), Return(value=Name(id='result', ctx=Load()))], decorator_list=[]), Return(value=Name(id='wrapper', ctx=Load()))], decorator_list=[]), Return(value=Name(id='_persist', ctx=Load()))], decorator_list=[])], type_ignores=[])Module(body=[FunctionDef(name='get_path', args=arguments(posonlyargs=[], args=[arg(arg='seq'), arg(arg='home_dir')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='path', ctx=Store())], value=Call(func=Attribute(value=Name(id='glob', ctx=Load()), attr='glob', ctx=Load()), args=[BinOp(left=Name(id='home_dir', ctx=Load()), op=Add(), right=JoinedStr(values=[Constant(value='/*/'), FormattedValue(value=Name(id='seq', ctx=Load()), conversion=-1), Constant(value='/'), FormattedValue(value=Name(id='seq', ctx=Load()), conversion=-1), Constant(value='.mcap')]))], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='path', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]), msg=Constant(value='sequence not found or ambiguous')), Return(value=Subscript(value=Name(id='path', ctx=Load()), slice=Constant(value=0), ctx=Load()))], decorator_list=[])], type_ignores=[])Module(body=[FunctionDef(name='_load_gt_poses', args=arguments(posonlyargs=[], args=[arg(arg='bagfile'), arg(arg='navsat_topic'), arg(arg='imu_topic'), arg(arg='normalize_ori'), arg(arg='normalize_pos'), arg(arg='cart_pos'), arg(arg='try_quickload'), arg(arg='save_to_file')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='/ref_sys/NavSatFix_INS'), Constant(value='/ref_sys/inat_imu'), Constant(value=True), Constant(value=True), Constant(value=True), Constant(value=True), Constant(value=True)]), body=[FunctionDef(name='calc_poses_from_pos_and_ori', args=arguments(posonlyargs=[], args=[arg(arg='timestamps'), arg(arg='pos_ts'), arg(arg='pos'), arg(arg='ori_ts'), arg(arg='ori')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Tuple(elts=[Name(id='_', ctx=Store()), Name(id='pos', ctx=Store())], ctx=Store())], value=Call(func=Name(id='interpolate_poses_linear', ctx=Load()), args=[Name(id='timestamps', ctx=Load()), Name(id='pos_ts', ctx=Load()), Name(id='pos', ctx=Load())], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='_', ctx=Store()), Name(id='ori', ctx=Store())], ctx=Store())], value=Call(func=Name(id='interpolate_poses_linear', ctx=Load()), args=[Name(id='timestamps', ctx=Load()), Name(id='ori_ts', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='pos', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Call(func=Name(id='len', ctx=Load()), args=[Name(id='ori', ctx=Load())], keywords=[])])), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[Attribute(value=Name(id='p', ctx=Load()), attr='t', ctx=Load()), Attribute(value=Name(id='o', ctx=Load()), attr='R', ctx=Load())], keywords=[]), generators=[comprehension(target=Tuple(elts=[Name(id='p', ctx=Store()), Name(id='o', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='zip', ctx=Load()), args=[Name(id='pos', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[]), ifs=[], is_async=0)])], keywords=[])), Return(value=Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='poses', ctx=Load())], ctx=Load()))], decorator_list=[]), FunctionDef(name='interpolate_poses_linear', args=arguments(posonlyargs=[], args=[arg(arg='timestamps'), arg(arg='timestamps_poses'), arg(arg='poses')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='get_idk', args=arguments(posonlyargs=[], args=[arg(arg='list'), arg(arg='element')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='greater', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='greater_equal', ctx=Load()), args=[Name(id='list', ctx=Load()), Name(id='element', ctx=Load())], keywords=[])), Assign(targets=[Name(id='first_greater', ctx=Store())], value=Subscript(value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='nonzero', ctx=Load()), args=[Name(id='greater', ctx=Load())], keywords=[]), slice=Constant(value=0), ctx=Load()), slice=Constant(value=0), ctx=Load())), Assign(targets=[Name(id='less', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='less_equal', ctx=Load()), args=[Name(id='list', ctx=Load()), Name(id='element', ctx=Load())], keywords=[])), Assign(targets=[Name(id='last_less', ctx=Store())], value=Subscript(value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='nonzero', ctx=Load()), args=[Name(id='less', ctx=Load())], keywords=[]), slice=Constant(value=0), ctx=Load()), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load())), Return(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='arange', ctx=Load()), args=[Name(id='last_less', ctx=Load()), BinOp(left=Name(id='first_greater', ctx=Load()), op=Add(), right=Constant(value=1)), Constant(value=1), Name(id='int', ctx=Load())], keywords=[]))], decorator_list=[]), Assign(targets=[Name(id='Ts', ctx=Store())], value=List(elts=[], ctx=Load())), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='t', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='timestamps', ctx=Load())], keywords=[]), body=[Try(body=[Assign(targets=[Name(id='inds', ctx=Store())], value=Call(func=Name(id='get_idk', ctx=Load()), args=[Name(id='timestamps_poses', ctx=Load()), Name(id='t', ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=Name(id='IndexError', ctx=Load()), name='e', body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[])), Continue()])], orelse=[], finalbody=[]), If(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='inds', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]), body=[Expr(value=Call(func=Attribute(value=Name(id='Ts', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='i', ctx=Load()), Subscript(value=Name(id='poses', ctx=Load()), slice=Subscript(value=Name(id='inds', ctx=Load()), slice=Constant(value=0), ctx=Load()), ctx=Load())], ctx=Load())], keywords=[]))], orelse=[Assign(targets=[Tuple(elts=[Name(id='pose_1', ctx=Store()), Name(id='pose_2', ctx=Store())], ctx=Store())], value=Subscript(value=Name(id='poses', ctx=Load()), slice=Name(id='inds', ctx=Load()), ctx=Load())), Assign(targets=[Tuple(elts=[Name(id='time_1', ctx=Store()), Name(id='time_2', ctx=Store())], ctx=Store())], value=Subscript(value=Name(id='timestamps_poses', ctx=Load()), slice=Name(id='inds', ctx=Load()), ctx=Load())), Assign(targets=[Name(id='dt2', ctx=Store())], value=BinOp(left=Name(id='time_2', ctx=Load()), op=Sub(), right=Name(id='time_1', ctx=Load()))), Assign(targets=[Name(id='dt', ctx=Store())], value=BinOp(left=Name(id='t', ctx=Load()), op=Sub(), right=Name(id='time_1', ctx=Load()))), Assign(targets=[Name(id='f', ctx=Store())], value=BinOp(left=Name(id='dt', ctx=Load()), op=Div(), right=Name(id='dt2', ctx=Load()))), Assert(test=BoolOp(op=And(), values=[Compare(left=Name(id='f', ctx=Load()), ops=[GtE()], comparators=[Constant(value=0)]), Compare(left=Name(id='f', ctx=Load()), ops=[LtE()], comparators=[Constant(value=1)])])), Assign(targets=[Name(id='pose', ctx=Store())], value=BinOp(left=BinOp(left=BinOp(left=Constant(value=1), op=Sub(), right=Name(id='f', ctx=Load())), op=Mult(), right=Call(func=Attribute(value=Name(id='pose_1', ctx=Load()), attr='log', ctx=Load()), args=[], keywords=[])), op=Add(), right=BinOp(left=Name(id='f', ctx=Load()), op=Mult(), right=Call(func=Attribute(value=Name(id='pose_2', ctx=Load()), attr='log', ctx=Load()), args=[], keywords=[])))), Assign(targets=[Name(id='pose', ctx=Store())], value=Call(func=Attribute(value=Name(id='SE3', ctx=Load()), attr='exp', ctx=Load()), args=[Name(id='pose', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='Ts', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='i', ctx=Load()), Name(id='pose', ctx=Load())], ctx=Load())], keywords=[]))])], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='indices', ctx=Store()), Name(id='poses', ctx=Store())], ctx=Store())], value=Call(func=Name(id='zip', ctx=Load()), args=[Starred(value=Name(id='Ts', ctx=Load()), ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[Name(id='indices', ctx=Load())], keywords=[]), Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[Name(id='poses', ctx=Load())], keywords=[])], ctx=Load()))], decorator_list=[]), If(test=BoolOp(op=Or(), values=[Name(id='try_quickload', ctx=Load()), Name(id='save_to_file', ctx=Load())]), body=[Assign(targets=[Name(id='bytes_s', ctx=Store())], value=ListComp(elt=Call(func=Attribute(value=Name(id='dill', ctx=Load()), attr='dumps', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=List(elts=[Name(id='bagfile', ctx=Load()), Name(id='navsat_topic', ctx=Load()), Name(id='imu_topic', ctx=Load()), Name(id='normalize_ori', ctx=Load()), Name(id='normalize_pos', ctx=Load()), Name(id='cart_pos', ctx=Load())], ctx=Load()), ifs=[], is_async=0)])), Assign(targets=[Name(id='bytes', ctx=Store())], value=Call(func=Attribute(value=Name(id='functools', ctx=Load()), attr='reduce', ctx=Load()), args=[Lambda(args=arguments(posonlyargs=[], args=[arg(arg='a'), arg(arg='b')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=BinOp(left=Name(id='a', ctx=Load()), op=Add(), right=Name(id='b', ctx=Load()))), Name(id='bytes_s', ctx=Load())], keywords=[])), Assign(targets=[Name(id='hash', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='sha1', ctx=Load()), args=[Name(id='bytes', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='bagfile_dir', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), args=[Name(id='bagfile', ctx=Load())], keywords=[]), attr='resolve', ctx=Load()), args=[], keywords=[]), attr='parent', ctx=Load())), Assign(targets=[Name(id='pickle_dir', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='joinpath', ctx=Load()), args=[Name(id='bagfile_dir', ctx=Load()), Constant(value='pickles')], keywords=[])), Assign(targets=[Name(id='pickle_file', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='joinpath', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load()), Name(id='hash', ctx=Load())], keywords=[]))], orelse=[]), If(test=BoolOp(op=And(), values=[Name(id='try_quickload', ctx=Load()), Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='exists', ctx=Load()), args=[Name(id='pickle_file', ctx=Load())], keywords=[])]), body=[With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Name(id='pickle_file', ctx=Load()), Constant(value='rb')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Assign(targets=[Tuple(elts=[Name(id='timestamps', ctx=Store()), Name(id='matrices', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='pickle', ctx=Load()), attr='load', ctx=Load()), args=[Name(id='f', ctx=Load())], keywords=[]))])], orelse=[Assign(targets=[Name(id='T_correction', ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='R', value=Call(func=Attribute(value=Name(id='Rotation', ctx=Load()), attr='from_rotvec', ctx=Load()), args=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[List(elts=[Constant(value=0), Constant(value=0), BinOp(left=UnaryOp(op=USub(), operand=Attribute(value=Name(id='np', ctx=Load()), attr='pi', ctx=Load())), op=Div(), right=Constant(value=2))], ctx=Load())], keywords=[])], keywords=[]))])), Assign(targets=[Tuple(elts=[Name(id='timestamps_pos', ctx=Store()), Name(id='pos', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='abstract_reader', ctx=Load()), args=[Name(id='bagfile', ctx=Load()), Name(id='navsat_topic', ctx=Load()), Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='parse_navsatfix_msg', ctx=Load()), Constant(value=True), Constant(value=True)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='ori_timestamps', ctx=Store()), Name(id='ori', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='abstract_reader', ctx=Load()), args=[Name(id='bagfile', ctx=Load()), Name(id='imu_topic', ctx=Load()), Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='parse_imu_msg', ctx=Load()), Constant(value=True), Constant(value=True)], keywords=[])), Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='t', value=Name(id='e', ctx=Load()))]), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=Name(id='pos', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='ori', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=BinOp(left=Name(id='T_correction', ctx=Load()), op=Mult(), right=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='R', value=Name(id='e', ctx=Load()))])), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=Name(id='ori', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='T', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='ori', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='euler', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='T', ctx=Load()), attr='R', ctx=Load()), attr='as_euler', ctx=Load()), args=[Constant(value='XYZ')], keywords=[])), AugAssign(target=Subscript(value=Name(id='euler', ctx=Load()), slice=Slice(lower=Constant(value=1)), ctx=Store()), op=Mult(), value=UnaryOp(op=USub(), operand=Constant(value=1))), Assign(targets=[Subscript(value=Name(id='ori', ctx=Load()), slice=Name(id='i', ctx=Load()), ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[Attribute(value=Name(id='T', ctx=Load()), attr='t', ctx=Load()), Call(func=Attribute(value=Name(id='Rotation', ctx=Load()), attr='from_euler', ctx=Load()), args=[Constant(value='XYZ'), Name(id='euler', ctx=Load())], keywords=[])], keywords=[]))], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='timestamps', ctx=Store()), Name(id='poses', ctx=Store())], ctx=Store())], value=Call(func=Name(id='calc_poses_from_pos_and_ori', ctx=Load()), args=[Name(id='timestamps_pos', ctx=Load()), Name(id='timestamps_pos', ctx=Load()), Name(id='pos', ctx=Load()), Name(id='ori_timestamps', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[])), Assert(test=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='all', ctx=Load()), args=[Compare(left=Name(id='timestamps', ctx=Load()), ops=[Eq()], comparators=[Name(id='timestamps_pos', ctx=Load())])], keywords=[])), If(test=Name(id='cart_pos', ctx=Load()), body=[Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Attribute(value=Name(id='T', ctx=Load()), attr='t', ctx=Load()), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='util', ctx=Load()), attr='llas_to_cart', ctx=Load()), args=[Name(id='pos', ctx=Load()), Subscript(value=Name(id='pos', ctx=Load()), slice=Constant(value=0), ctx=Load())], keywords=[])), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[Name(id='t', ctx=Load()), Attribute(value=Name(id='T', ctx=Load()), attr='R', ctx=Load())], keywords=[]), generators=[comprehension(target=Tuple(elts=[Name(id='t', ctx=Store()), Name(id='T', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='zip', ctx=Load()), args=[Name(id='pos', ctx=Load()), Name(id='poses', ctx=Load())], keywords=[]), ifs=[], is_async=0)])], keywords=[]))], orelse=[]), Assign(targets=[Name(id='T_norm', ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[])), If(test=Name(id='normalize_ori', ctx=Load()), body=[Assign(targets=[Attribute(value=Name(id='T_norm', ctx=Load()), attr='R', ctx=Store())], value=Attribute(value=Subscript(value=Name(id='poses', ctx=Load()), slice=Constant(value=0), ctx=Load()), attr='R', ctx=Load()))], orelse=[]), If(test=Name(id='normalize_pos', ctx=Load()), body=[Assign(targets=[Attribute(value=Name(id='T_norm', ctx=Load()), attr='t', ctx=Store())], value=Attribute(value=Subscript(value=Name(id='poses', ctx=Load()), slice=Constant(value=0), ctx=Load()), attr='t', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=BinOp(left=Call(func=Attribute(value=Name(id='T_norm', ctx=Load()), attr='inv', ctx=Load()), args=[], keywords=[]), op=Mult(), right=Name(id='T', ctx=Load())), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='matrices', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Attribute(value=Name(id='T', ctx=Load()), attr='matrix', ctx=Load()), args=[], keywords=[]), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), If(test=Name(id='save_to_file', ctx=Load()), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='exists', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load())], keywords=[])), body=[Expr(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='makedirs', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load())], keywords=[]))], orelse=[]), With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Name(id='pickle_file', ctx=Load()), Constant(value='wb')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Expr(value=Call(func=Attribute(value=Name(id='pickle', ctx=Load()), attr='dump', ctx=Load()), args=[Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='matrices', ctx=Load())], ctx=Load()), Name(id='f', ctx=Load())], keywords=[]))])], orelse=[])]), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='RBT', ctx=Load()), attr='From_Matrix', ctx=Load()), args=[Name(id='matrices', ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='poses', ctx=Load())], ctx=Load()))], decorator_list=[])], type_ignores=[])", "args": ["r1", "/media/aaron/aaron_ssd/datasets/OKULAr/"], "kwargs": {}, "bin_id": 0}, {"ast": "Module(body=[FunctionDef(name='load_gt_poses', args=arguments(posonlyargs=[], args=[arg(arg='seq'), arg(arg='home_dir')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='/home/aaron/datasets/OKULAr')]), body=[Assign(targets=[Name(id='path', ctx=Store())], value=Call(func=Name(id='get_path', ctx=Load()), args=[Name(id='seq', ctx=Load()), Name(id='home_dir', ctx=Load())], keywords=[])), Return(value=Call(func=Name(id='_load_gt_poses', ctx=Load()), args=[Name(id='path', ctx=Load())], keywords=[]))], decorator_list=[Call(func=Name(id='persist', ctx=Load()), args=[], keywords=[keyword(arg='depth', value=Constant(value=3)), keyword(arg='verbose', value=Constant(value=True))])])], type_ignores=[])Module(body=[FunctionDef(name='persist', args=arguments(posonlyargs=[], args=[arg(arg='depth'), arg(arg='verbose')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=0), Constant(value=False)]), body=[FunctionDef(name='_persist', args=arguments(posonlyargs=[], args=[arg(arg='func')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='wrapper', args=arguments(posonlyargs=[], args=[], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[]), body=[Assign(targets=[Name(id='function_call', ctx=Store())], value=Call(func=Name(id='Function_Call', ctx=Load()), args=[Name(id='func', ctx=Load()), Name(id='args', ctx=Load()), Name(id='kwargs', ctx=Load()), Constant(value=1)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='success', ctx=Store()), Name(id='persisted_result', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='function_call', ctx=Load()), attr='Load_Results', ctx=Load()), args=[], keywords=[])), If(test=Name(id='success', ctx=Load()), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[JoinedStr(values=[Constant(value='Successfully loaded results for:'), FormattedValue(value=Name(id='func', ctx=Load()), conversion=-1)])], keywords=[])), Return(value=Name(id='persisted_result', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='result', ctx=Store())], value=Call(func=Name(id='func', ctx=Load()), args=[Starred(value=Name(id='args', ctx=Load()), ctx=Load())], keywords=[keyword(value=Name(id='kwargs', ctx=Load()))])), Expr(value=Call(func=Attribute(value=Name(id='function_call', ctx=Load()), attr='Save_Results', ctx=Load()), args=[Name(id='result', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[JoinedStr(values=[Constant(value='Successfully saved results for:'), FormattedValue(value=Name(id='func', ctx=Load()), conversion=-1)])], keywords=[])), Return(value=Name(id='result', ctx=Load()))], decorator_list=[]), Return(value=Name(id='wrapper', ctx=Load()))], decorator_list=[]), Return(value=Name(id='_persist', ctx=Load()))], decorator_list=[])], type_ignores=[])Module(body=[FunctionDef(name='get_path', args=arguments(posonlyargs=[], args=[arg(arg='seq'), arg(arg='home_dir')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='path', ctx=Store())], value=Call(func=Attribute(value=Name(id='glob', ctx=Load()), attr='glob', ctx=Load()), args=[BinOp(left=Name(id='home_dir', ctx=Load()), op=Add(), right=JoinedStr(values=[Constant(value='/*/'), FormattedValue(value=Name(id='seq', ctx=Load()), conversion=-1), Constant(value='/'), FormattedValue(value=Name(id='seq', ctx=Load()), conversion=-1), Constant(value='.mcap')]))], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='path', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]), msg=Constant(value='sequence not found or ambiguous')), Return(value=Subscript(value=Name(id='path', ctx=Load()), slice=Constant(value=0), ctx=Load()))], decorator_list=[])], type_ignores=[])Module(body=[FunctionDef(name='_load_gt_poses', args=arguments(posonlyargs=[], args=[arg(arg='bagfile'), arg(arg='navsat_topic'), arg(arg='imu_topic'), arg(arg='normalize_ori'), arg(arg='normalize_pos'), arg(arg='cart_pos'), arg(arg='try_quickload'), arg(arg='save_to_file')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='/ref_sys/NavSatFix_INS'), Constant(value='/ref_sys/inat_imu'), Constant(value=True), Constant(value=True), Constant(value=True), Constant(value=True), Constant(value=True)]), body=[FunctionDef(name='calc_poses_from_pos_and_ori', args=arguments(posonlyargs=[], args=[arg(arg='timestamps'), arg(arg='pos_ts'), arg(arg='pos'), arg(arg='ori_ts'), arg(arg='ori')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Tuple(elts=[Name(id='_', ctx=Store()), Name(id='pos', ctx=Store())], ctx=Store())], value=Call(func=Name(id='interpolate_poses_linear', ctx=Load()), args=[Name(id='timestamps', ctx=Load()), Name(id='pos_ts', ctx=Load()), Name(id='pos', ctx=Load())], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='_', ctx=Store()), Name(id='ori', ctx=Store())], ctx=Store())], value=Call(func=Name(id='interpolate_poses_linear', ctx=Load()), args=[Name(id='timestamps', ctx=Load()), Name(id='ori_ts', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='pos', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Call(func=Name(id='len', ctx=Load()), args=[Name(id='ori', ctx=Load())], keywords=[])])), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[Attribute(value=Name(id='p', ctx=Load()), attr='t', ctx=Load()), Attribute(value=Name(id='o', ctx=Load()), attr='R', ctx=Load())], keywords=[]), generators=[comprehension(target=Tuple(elts=[Name(id='p', ctx=Store()), Name(id='o', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='zip', ctx=Load()), args=[Name(id='pos', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[]), ifs=[], is_async=0)])], keywords=[])), Return(value=Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='poses', ctx=Load())], ctx=Load()))], decorator_list=[]), FunctionDef(name='interpolate_poses_linear', args=arguments(posonlyargs=[], args=[arg(arg='timestamps'), arg(arg='timestamps_poses'), arg(arg='poses')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='get_idk', args=arguments(posonlyargs=[], args=[arg(arg='list'), arg(arg='element')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='greater', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='greater_equal', ctx=Load()), args=[Name(id='list', ctx=Load()), Name(id='element', ctx=Load())], keywords=[])), Assign(targets=[Name(id='first_greater', ctx=Store())], value=Subscript(value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='nonzero', ctx=Load()), args=[Name(id='greater', ctx=Load())], keywords=[]), slice=Constant(value=0), ctx=Load()), slice=Constant(value=0), ctx=Load())), Assign(targets=[Name(id='less', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='less_equal', ctx=Load()), args=[Name(id='list', ctx=Load()), Name(id='element', ctx=Load())], keywords=[])), Assign(targets=[Name(id='last_less', ctx=Store())], value=Subscript(value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='nonzero', ctx=Load()), args=[Name(id='less', ctx=Load())], keywords=[]), slice=Constant(value=0), ctx=Load()), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load())), Return(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='arange', ctx=Load()), args=[Name(id='last_less', ctx=Load()), BinOp(left=Name(id='first_greater', ctx=Load()), op=Add(), right=Constant(value=1)), Constant(value=1), Name(id='int', ctx=Load())], keywords=[]))], decorator_list=[]), Assign(targets=[Name(id='Ts', ctx=Store())], value=List(elts=[], ctx=Load())), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='t', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='timestamps', ctx=Load())], keywords=[]), body=[Try(body=[Assign(targets=[Name(id='inds', ctx=Store())], value=Call(func=Name(id='get_idk', ctx=Load()), args=[Name(id='timestamps_poses', ctx=Load()), Name(id='t', ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=Name(id='IndexError', ctx=Load()), name='e', body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[])), Continue()])], orelse=[], finalbody=[]), If(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='inds', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]), body=[Expr(value=Call(func=Attribute(value=Name(id='Ts', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='i', ctx=Load()), Subscript(value=Name(id='poses', ctx=Load()), slice=Subscript(value=Name(id='inds', ctx=Load()), slice=Constant(value=0), ctx=Load()), ctx=Load())], ctx=Load())], keywords=[]))], orelse=[Assign(targets=[Tuple(elts=[Name(id='pose_1', ctx=Store()), Name(id='pose_2', ctx=Store())], ctx=Store())], value=Subscript(value=Name(id='poses', ctx=Load()), slice=Name(id='inds', ctx=Load()), ctx=Load())), Assign(targets=[Tuple(elts=[Name(id='time_1', ctx=Store()), Name(id='time_2', ctx=Store())], ctx=Store())], value=Subscript(value=Name(id='timestamps_poses', ctx=Load()), slice=Name(id='inds', ctx=Load()), ctx=Load())), Assign(targets=[Name(id='dt2', ctx=Store())], value=BinOp(left=Name(id='time_2', ctx=Load()), op=Sub(), right=Name(id='time_1', ctx=Load()))), Assign(targets=[Name(id='dt', ctx=Store())], value=BinOp(left=Name(id='t', ctx=Load()), op=Sub(), right=Name(id='time_1', ctx=Load()))), Assign(targets=[Name(id='f', ctx=Store())], value=BinOp(left=Name(id='dt', ctx=Load()), op=Div(), right=Name(id='dt2', ctx=Load()))), Assert(test=BoolOp(op=And(), values=[Compare(left=Name(id='f', ctx=Load()), ops=[GtE()], comparators=[Constant(value=0)]), Compare(left=Name(id='f', ctx=Load()), ops=[LtE()], comparators=[Constant(value=1)])])), Assign(targets=[Name(id='pose', ctx=Store())], value=BinOp(left=BinOp(left=BinOp(left=Constant(value=1), op=Sub(), right=Name(id='f', ctx=Load())), op=Mult(), right=Call(func=Attribute(value=Name(id='pose_1', ctx=Load()), attr='log', ctx=Load()), args=[], keywords=[])), op=Add(), right=BinOp(left=Name(id='f', ctx=Load()), op=Mult(), right=Call(func=Attribute(value=Name(id='pose_2', ctx=Load()), attr='log', ctx=Load()), args=[], keywords=[])))), Assign(targets=[Name(id='pose', ctx=Store())], value=Call(func=Attribute(value=Name(id='SE3', ctx=Load()), attr='exp', ctx=Load()), args=[Name(id='pose', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='Ts', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='i', ctx=Load()), Name(id='pose', ctx=Load())], ctx=Load())], keywords=[]))])], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='indices', ctx=Store()), Name(id='poses', ctx=Store())], ctx=Store())], value=Call(func=Name(id='zip', ctx=Load()), args=[Starred(value=Name(id='Ts', ctx=Load()), ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[Name(id='indices', ctx=Load())], keywords=[]), Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[Name(id='poses', ctx=Load())], keywords=[])], ctx=Load()))], decorator_list=[]), If(test=BoolOp(op=Or(), values=[Name(id='try_quickload', ctx=Load()), Name(id='save_to_file', ctx=Load())]), body=[Assign(targets=[Name(id='bytes_s', ctx=Store())], value=ListComp(elt=Call(func=Attribute(value=Name(id='dill', ctx=Load()), attr='dumps', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=List(elts=[Name(id='bagfile', ctx=Load()), Name(id='navsat_topic', ctx=Load()), Name(id='imu_topic', ctx=Load()), Name(id='normalize_ori', ctx=Load()), Name(id='normalize_pos', ctx=Load()), Name(id='cart_pos', ctx=Load())], ctx=Load()), ifs=[], is_async=0)])), Assign(targets=[Name(id='bytes', ctx=Store())], value=Call(func=Attribute(value=Name(id='functools', ctx=Load()), attr='reduce', ctx=Load()), args=[Lambda(args=arguments(posonlyargs=[], args=[arg(arg='a'), arg(arg='b')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=BinOp(left=Name(id='a', ctx=Load()), op=Add(), right=Name(id='b', ctx=Load()))), Name(id='bytes_s', ctx=Load())], keywords=[])), Assign(targets=[Name(id='hash', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='sha1', ctx=Load()), args=[Name(id='bytes', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='bagfile_dir', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), args=[Name(id='bagfile', ctx=Load())], keywords=[]), attr='resolve', ctx=Load()), args=[], keywords=[]), attr='parent', ctx=Load())), Assign(targets=[Name(id='pickle_dir', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='joinpath', ctx=Load()), args=[Name(id='bagfile_dir', ctx=Load()), Constant(value='pickles')], keywords=[])), Assign(targets=[Name(id='pickle_file', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='joinpath', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load()), Name(id='hash', ctx=Load())], keywords=[]))], orelse=[]), If(test=BoolOp(op=And(), values=[Name(id='try_quickload', ctx=Load()), Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='exists', ctx=Load()), args=[Name(id='pickle_file', ctx=Load())], keywords=[])]), body=[With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Name(id='pickle_file', ctx=Load()), Constant(value='rb')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Assign(targets=[Tuple(elts=[Name(id='timestamps', ctx=Store()), Name(id='matrices', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='pickle', ctx=Load()), attr='load', ctx=Load()), args=[Name(id='f', ctx=Load())], keywords=[]))])], orelse=[Assign(targets=[Name(id='T_correction', ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='R', value=Call(func=Attribute(value=Name(id='Rotation', ctx=Load()), attr='from_rotvec', ctx=Load()), args=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[List(elts=[Constant(value=0), Constant(value=0), BinOp(left=UnaryOp(op=USub(), operand=Attribute(value=Name(id='np', ctx=Load()), attr='pi', ctx=Load())), op=Div(), right=Constant(value=2))], ctx=Load())], keywords=[])], keywords=[]))])), Assign(targets=[Tuple(elts=[Name(id='timestamps_pos', ctx=Store()), Name(id='pos', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='abstract_reader', ctx=Load()), args=[Name(id='bagfile', ctx=Load()), Name(id='navsat_topic', ctx=Load()), Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='parse_navsatfix_msg', ctx=Load()), Constant(value=True), Constant(value=True)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='ori_timestamps', ctx=Store()), Name(id='ori', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='abstract_reader', ctx=Load()), args=[Name(id='bagfile', ctx=Load()), Name(id='imu_topic', ctx=Load()), Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='parse_imu_msg', ctx=Load()), Constant(value=True), Constant(value=True)], keywords=[])), Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='t', value=Name(id='e', ctx=Load()))]), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=Name(id='pos', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='ori', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=BinOp(left=Name(id='T_correction', ctx=Load()), op=Mult(), right=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='R', value=Name(id='e', ctx=Load()))])), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=Name(id='ori', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='T', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='ori', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='euler', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='T', ctx=Load()), attr='R', ctx=Load()), attr='as_euler', ctx=Load()), args=[Constant(value='XYZ')], keywords=[])), AugAssign(target=Subscript(value=Name(id='euler', ctx=Load()), slice=Slice(lower=Constant(value=1)), ctx=Store()), op=Mult(), value=UnaryOp(op=USub(), operand=Constant(value=1))), Assign(targets=[Subscript(value=Name(id='ori', ctx=Load()), slice=Name(id='i', ctx=Load()), ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[Attribute(value=Name(id='T', ctx=Load()), attr='t', ctx=Load()), Call(func=Attribute(value=Name(id='Rotation', ctx=Load()), attr='from_euler', ctx=Load()), args=[Constant(value='XYZ'), Name(id='euler', ctx=Load())], keywords=[])], keywords=[]))], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='timestamps', ctx=Store()), Name(id='poses', ctx=Store())], ctx=Store())], value=Call(func=Name(id='calc_poses_from_pos_and_ori', ctx=Load()), args=[Name(id='timestamps_pos', ctx=Load()), Name(id='timestamps_pos', ctx=Load()), Name(id='pos', ctx=Load()), Name(id='ori_timestamps', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[])), Assert(test=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='all', ctx=Load()), args=[Compare(left=Name(id='timestamps', ctx=Load()), ops=[Eq()], comparators=[Name(id='timestamps_pos', ctx=Load())])], keywords=[])), If(test=Name(id='cart_pos', ctx=Load()), body=[Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Attribute(value=Name(id='T', ctx=Load()), attr='t', ctx=Load()), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='util', ctx=Load()), attr='llas_to_cart', ctx=Load()), args=[Name(id='pos', ctx=Load()), Subscript(value=Name(id='pos', ctx=Load()), slice=Constant(value=0), ctx=Load())], keywords=[])), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[Name(id='t', ctx=Load()), Attribute(value=Name(id='T', ctx=Load()), attr='R', ctx=Load())], keywords=[]), generators=[comprehension(target=Tuple(elts=[Name(id='t', ctx=Store()), Name(id='T', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='zip', ctx=Load()), args=[Name(id='pos', ctx=Load()), Name(id='poses', ctx=Load())], keywords=[]), ifs=[], is_async=0)])], keywords=[]))], orelse=[]), Assign(targets=[Name(id='T_norm', ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[])), If(test=Name(id='normalize_ori', ctx=Load()), body=[Assign(targets=[Attribute(value=Name(id='T_norm', ctx=Load()), attr='R', ctx=Store())], value=Attribute(value=Subscript(value=Name(id='poses', ctx=Load()), slice=Constant(value=0), ctx=Load()), attr='R', ctx=Load()))], orelse=[]), If(test=Name(id='normalize_pos', ctx=Load()), body=[Assign(targets=[Attribute(value=Name(id='T_norm', ctx=Load()), attr='t', ctx=Store())], value=Attribute(value=Subscript(value=Name(id='poses', ctx=Load()), slice=Constant(value=0), ctx=Load()), attr='t', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=BinOp(left=Call(func=Attribute(value=Name(id='T_norm', ctx=Load()), attr='inv', ctx=Load()), args=[], keywords=[]), op=Mult(), right=Name(id='T', ctx=Load())), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='matrices', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Attribute(value=Name(id='T', ctx=Load()), attr='matrix', ctx=Load()), args=[], keywords=[]), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), If(test=Name(id='save_to_file', ctx=Load()), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='exists', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load())], keywords=[])), body=[Expr(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='makedirs', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load())], keywords=[]))], orelse=[]), With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Name(id='pickle_file', ctx=Load()), Constant(value='wb')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Expr(value=Call(func=Attribute(value=Name(id='pickle', ctx=Load()), attr='dump', ctx=Load()), args=[Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='matrices', ctx=Load())], ctx=Load()), Name(id='f', ctx=Load())], keywords=[]))])], orelse=[])]), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='RBT', ctx=Load()), attr='From_Matrix', ctx=Load()), args=[Name(id='matrices', ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='poses', ctx=Load())], ctx=Load()))], decorator_list=[])], type_ignores=[])", "args": ["r2", "/media/aaron/aaron_ssd/datasets/OKULAr/"], "kwargs": {}, "bin_id": 1}, {"ast": "Module(body=[FunctionDef(name='load_gt_poses', args=arguments(posonlyargs=[], args=[arg(arg='seq'), arg(arg='home_dir')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='/home/aaron/datasets/OKULAr')]), body=[Assign(targets=[Name(id='path', ctx=Store())], value=Call(func=Name(id='get_path', ctx=Load()), args=[Name(id='seq', ctx=Load()), Name(id='home_dir', ctx=Load())], keywords=[])), Return(value=Call(func=Name(id='_load_gt_poses', ctx=Load()), args=[Name(id='path', ctx=Load())], keywords=[]))], decorator_list=[Call(func=Name(id='persist', ctx=Load()), args=[], keywords=[keyword(arg='depth', value=Constant(value=3)), keyword(arg='verbose', value=Constant(value=True))])])], type_ignores=[])Module(body=[FunctionDef(name='persist', args=arguments(posonlyargs=[], args=[arg(arg='depth'), arg(arg='verbose')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=0), Constant(value=False)]), body=[FunctionDef(name='_persist', args=arguments(posonlyargs=[], args=[arg(arg='func')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='wrapper', args=arguments(posonlyargs=[], args=[], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[]), body=[Assign(targets=[Name(id='function_call', ctx=Store())], value=Call(func=Name(id='Function_Call', ctx=Load()), args=[Name(id='func', ctx=Load()), Name(id='args', ctx=Load()), Name(id='kwargs', ctx=Load()), Constant(value=1)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='success', ctx=Store()), Name(id='persisted_result', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='function_call', ctx=Load()), attr='Load_Results', ctx=Load()), args=[], keywords=[])), If(test=Name(id='success', ctx=Load()), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[JoinedStr(values=[Constant(value='Successfully loaded results for:'), FormattedValue(value=Name(id='func', ctx=Load()), conversion=-1)])], keywords=[])), Return(value=Name(id='persisted_result', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='result', ctx=Store())], value=Call(func=Name(id='func', ctx=Load()), args=[Starred(value=Name(id='args', ctx=Load()), ctx=Load())], keywords=[keyword(value=Name(id='kwargs', ctx=Load()))])), Expr(value=Call(func=Attribute(value=Name(id='function_call', ctx=Load()), attr='Save_Results', ctx=Load()), args=[Name(id='result', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[JoinedStr(values=[Constant(value='Successfully saved results for:'), FormattedValue(value=Name(id='func', ctx=Load()), conversion=-1)])], keywords=[])), Return(value=Name(id='result', ctx=Load()))], decorator_list=[]), Return(value=Name(id='wrapper', ctx=Load()))], decorator_list=[]), Return(value=Name(id='_persist', ctx=Load()))], decorator_list=[])], type_ignores=[])Module(body=[FunctionDef(name='get_path', args=arguments(posonlyargs=[], args=[arg(arg='seq'), arg(arg='home_dir')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='path', ctx=Store())], value=Call(func=Attribute(value=Name(id='glob', ctx=Load()), attr='glob', ctx=Load()), args=[BinOp(left=Name(id='home_dir', ctx=Load()), op=Add(), right=JoinedStr(values=[Constant(value='/*/'), FormattedValue(value=Name(id='seq', ctx=Load()), conversion=-1), Constant(value='/'), FormattedValue(value=Name(id='seq', ctx=Load()), conversion=-1), Constant(value='.mcap')]))], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='path', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]), msg=Constant(value='sequence not found or ambiguous')), Return(value=Subscript(value=Name(id='path', ctx=Load()), slice=Constant(value=0), ctx=Load()))], decorator_list=[])], type_ignores=[])Module(body=[FunctionDef(name='_load_gt_poses', args=arguments(posonlyargs=[], args=[arg(arg='bagfile'), arg(arg='navsat_topic'), arg(arg='imu_topic'), arg(arg='normalize_ori'), arg(arg='normalize_pos'), arg(arg='cart_pos'), arg(arg='try_quickload'), arg(arg='save_to_file')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='/ref_sys/NavSatFix_INS'), Constant(value='/ref_sys/inat_imu'), Constant(value=True), Constant(value=True), Constant(value=True), Constant(value=True), Constant(value=True)]), body=[FunctionDef(name='calc_poses_from_pos_and_ori', args=arguments(posonlyargs=[], args=[arg(arg='timestamps'), arg(arg='pos_ts'), arg(arg='pos'), arg(arg='ori_ts'), arg(arg='ori')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Tuple(elts=[Name(id='_', ctx=Store()), Name(id='pos', ctx=Store())], ctx=Store())], value=Call(func=Name(id='interpolate_poses_linear', ctx=Load()), args=[Name(id='timestamps', ctx=Load()), Name(id='pos_ts', ctx=Load()), Name(id='pos', ctx=Load())], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='_', ctx=Store()), Name(id='ori', ctx=Store())], ctx=Store())], value=Call(func=Name(id='interpolate_poses_linear', ctx=Load()), args=[Name(id='timestamps', ctx=Load()), Name(id='ori_ts', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='pos', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Call(func=Name(id='len', ctx=Load()), args=[Name(id='ori', ctx=Load())], keywords=[])])), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[Attribute(value=Name(id='p', ctx=Load()), attr='t', ctx=Load()), Attribute(value=Name(id='o', ctx=Load()), attr='R', ctx=Load())], keywords=[]), generators=[comprehension(target=Tuple(elts=[Name(id='p', ctx=Store()), Name(id='o', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='zip', ctx=Load()), args=[Name(id='pos', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[]), ifs=[], is_async=0)])], keywords=[])), Return(value=Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='poses', ctx=Load())], ctx=Load()))], decorator_list=[]), FunctionDef(name='interpolate_poses_linear', args=arguments(posonlyargs=[], args=[arg(arg='timestamps'), arg(arg='timestamps_poses'), arg(arg='poses')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='get_idk', args=arguments(posonlyargs=[], args=[arg(arg='list'), arg(arg='element')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='greater', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='greater_equal', ctx=Load()), args=[Name(id='list', ctx=Load()), Name(id='element', ctx=Load())], keywords=[])), Assign(targets=[Name(id='first_greater', ctx=Store())], value=Subscript(value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='nonzero', ctx=Load()), args=[Name(id='greater', ctx=Load())], keywords=[]), slice=Constant(value=0), ctx=Load()), slice=Constant(value=0), ctx=Load())), Assign(targets=[Name(id='less', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='less_equal', ctx=Load()), args=[Name(id='list', ctx=Load()), Name(id='element', ctx=Load())], keywords=[])), Assign(targets=[Name(id='last_less', ctx=Store())], value=Subscript(value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='nonzero', ctx=Load()), args=[Name(id='less', ctx=Load())], keywords=[]), slice=Constant(value=0), ctx=Load()), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load())), Return(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='arange', ctx=Load()), args=[Name(id='last_less', ctx=Load()), BinOp(left=Name(id='first_greater', ctx=Load()), op=Add(), right=Constant(value=1)), Constant(value=1), Name(id='int', ctx=Load())], keywords=[]))], decorator_list=[]), Assign(targets=[Name(id='Ts', ctx=Store())], value=List(elts=[], ctx=Load())), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='t', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='timestamps', ctx=Load())], keywords=[]), body=[Try(body=[Assign(targets=[Name(id='inds', ctx=Store())], value=Call(func=Name(id='get_idk', ctx=Load()), args=[Name(id='timestamps_poses', ctx=Load()), Name(id='t', ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=Name(id='IndexError', ctx=Load()), name='e', body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[])), Continue()])], orelse=[], finalbody=[]), If(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='inds', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]), body=[Expr(value=Call(func=Attribute(value=Name(id='Ts', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='i', ctx=Load()), Subscript(value=Name(id='poses', ctx=Load()), slice=Subscript(value=Name(id='inds', ctx=Load()), slice=Constant(value=0), ctx=Load()), ctx=Load())], ctx=Load())], keywords=[]))], orelse=[Assign(targets=[Tuple(elts=[Name(id='pose_1', ctx=Store()), Name(id='pose_2', ctx=Store())], ctx=Store())], value=Subscript(value=Name(id='poses', ctx=Load()), slice=Name(id='inds', ctx=Load()), ctx=Load())), Assign(targets=[Tuple(elts=[Name(id='time_1', ctx=Store()), Name(id='time_2', ctx=Store())], ctx=Store())], value=Subscript(value=Name(id='timestamps_poses', ctx=Load()), slice=Name(id='inds', ctx=Load()), ctx=Load())), Assign(targets=[Name(id='dt2', ctx=Store())], value=BinOp(left=Name(id='time_2', ctx=Load()), op=Sub(), right=Name(id='time_1', ctx=Load()))), Assign(targets=[Name(id='dt', ctx=Store())], value=BinOp(left=Name(id='t', ctx=Load()), op=Sub(), right=Name(id='time_1', ctx=Load()))), Assign(targets=[Name(id='f', ctx=Store())], value=BinOp(left=Name(id='dt', ctx=Load()), op=Div(), right=Name(id='dt2', ctx=Load()))), Assert(test=BoolOp(op=And(), values=[Compare(left=Name(id='f', ctx=Load()), ops=[GtE()], comparators=[Constant(value=0)]), Compare(left=Name(id='f', ctx=Load()), ops=[LtE()], comparators=[Constant(value=1)])])), Assign(targets=[Name(id='pose', ctx=Store())], value=BinOp(left=BinOp(left=BinOp(left=Constant(value=1), op=Sub(), right=Name(id='f', ctx=Load())), op=Mult(), right=Call(func=Attribute(value=Name(id='pose_1', ctx=Load()), attr='log', ctx=Load()), args=[], keywords=[])), op=Add(), right=BinOp(left=Name(id='f', ctx=Load()), op=Mult(), right=Call(func=Attribute(value=Name(id='pose_2', ctx=Load()), attr='log', ctx=Load()), args=[], keywords=[])))), Assign(targets=[Name(id='pose', ctx=Store())], value=Call(func=Attribute(value=Name(id='SE3', ctx=Load()), attr='exp', ctx=Load()), args=[Name(id='pose', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='Ts', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='i', ctx=Load()), Name(id='pose', ctx=Load())], ctx=Load())], keywords=[]))])], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='indices', ctx=Store()), Name(id='poses', ctx=Store())], ctx=Store())], value=Call(func=Name(id='zip', ctx=Load()), args=[Starred(value=Name(id='Ts', ctx=Load()), ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[Name(id='indices', ctx=Load())], keywords=[]), Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[Name(id='poses', ctx=Load())], keywords=[])], ctx=Load()))], decorator_list=[]), If(test=BoolOp(op=Or(), values=[Name(id='try_quickload', ctx=Load()), Name(id='save_to_file', ctx=Load())]), body=[Assign(targets=[Name(id='bytes_s', ctx=Store())], value=ListComp(elt=Call(func=Attribute(value=Name(id='dill', ctx=Load()), attr='dumps', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=List(elts=[Name(id='bagfile', ctx=Load()), Name(id='navsat_topic', ctx=Load()), Name(id='imu_topic', ctx=Load()), Name(id='normalize_ori', ctx=Load()), Name(id='normalize_pos', ctx=Load()), Name(id='cart_pos', ctx=Load())], ctx=Load()), ifs=[], is_async=0)])), Assign(targets=[Name(id='bytes', ctx=Store())], value=Call(func=Attribute(value=Name(id='functools', ctx=Load()), attr='reduce', ctx=Load()), args=[Lambda(args=arguments(posonlyargs=[], args=[arg(arg='a'), arg(arg='b')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=BinOp(left=Name(id='a', ctx=Load()), op=Add(), right=Name(id='b', ctx=Load()))), Name(id='bytes_s', ctx=Load())], keywords=[])), Assign(targets=[Name(id='hash', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='sha1', ctx=Load()), args=[Name(id='bytes', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='bagfile_dir', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), args=[Name(id='bagfile', ctx=Load())], keywords=[]), attr='resolve', ctx=Load()), args=[], keywords=[]), attr='parent', ctx=Load())), Assign(targets=[Name(id='pickle_dir', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='joinpath', ctx=Load()), args=[Name(id='bagfile_dir', ctx=Load()), Constant(value='pickles')], keywords=[])), Assign(targets=[Name(id='pickle_file', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='joinpath', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load()), Name(id='hash', ctx=Load())], keywords=[]))], orelse=[]), If(test=BoolOp(op=And(), values=[Name(id='try_quickload', ctx=Load()), Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='exists', ctx=Load()), args=[Name(id='pickle_file', ctx=Load())], keywords=[])]), body=[With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Name(id='pickle_file', ctx=Load()), Constant(value='rb')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Assign(targets=[Tuple(elts=[Name(id='timestamps', ctx=Store()), Name(id='matrices', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='pickle', ctx=Load()), attr='load', ctx=Load()), args=[Name(id='f', ctx=Load())], keywords=[]))])], orelse=[Assign(targets=[Name(id='T_correction', ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='R', value=Call(func=Attribute(value=Name(id='Rotation', ctx=Load()), attr='from_rotvec', ctx=Load()), args=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[List(elts=[Constant(value=0), Constant(value=0), BinOp(left=UnaryOp(op=USub(), operand=Attribute(value=Name(id='np', ctx=Load()), attr='pi', ctx=Load())), op=Div(), right=Constant(value=2))], ctx=Load())], keywords=[])], keywords=[]))])), Assign(targets=[Tuple(elts=[Name(id='timestamps_pos', ctx=Store()), Name(id='pos', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='abstract_reader', ctx=Load()), args=[Name(id='bagfile', ctx=Load()), Name(id='navsat_topic', ctx=Load()), Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='parse_navsatfix_msg', ctx=Load()), Constant(value=True), Constant(value=True)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='ori_timestamps', ctx=Store()), Name(id='ori', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='abstract_reader', ctx=Load()), args=[Name(id='bagfile', ctx=Load()), Name(id='imu_topic', ctx=Load()), Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='parse_imu_msg', ctx=Load()), Constant(value=True), Constant(value=True)], keywords=[])), Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='t', value=Name(id='e', ctx=Load()))]), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=Name(id='pos', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='ori', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=BinOp(left=Name(id='T_correction', ctx=Load()), op=Mult(), right=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='R', value=Name(id='e', ctx=Load()))])), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=Name(id='ori', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='T', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='ori', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='euler', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='T', ctx=Load()), attr='R', ctx=Load()), attr='as_euler', ctx=Load()), args=[Constant(value='XYZ')], keywords=[])), AugAssign(target=Subscript(value=Name(id='euler', ctx=Load()), slice=Slice(lower=Constant(value=1)), ctx=Store()), op=Mult(), value=UnaryOp(op=USub(), operand=Constant(value=1))), Assign(targets=[Subscript(value=Name(id='ori', ctx=Load()), slice=Name(id='i', ctx=Load()), ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[Attribute(value=Name(id='T', ctx=Load()), attr='t', ctx=Load()), Call(func=Attribute(value=Name(id='Rotation', ctx=Load()), attr='from_euler', ctx=Load()), args=[Constant(value='XYZ'), Name(id='euler', ctx=Load())], keywords=[])], keywords=[]))], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='timestamps', ctx=Store()), Name(id='poses', ctx=Store())], ctx=Store())], value=Call(func=Name(id='calc_poses_from_pos_and_ori', ctx=Load()), args=[Name(id='timestamps_pos', ctx=Load()), Name(id='timestamps_pos', ctx=Load()), Name(id='pos', ctx=Load()), Name(id='ori_timestamps', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[])), Assert(test=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='all', ctx=Load()), args=[Compare(left=Name(id='timestamps', ctx=Load()), ops=[Eq()], comparators=[Name(id='timestamps_pos', ctx=Load())])], keywords=[])), If(test=Name(id='cart_pos', ctx=Load()), body=[Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Attribute(value=Name(id='T', ctx=Load()), attr='t', ctx=Load()), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='util', ctx=Load()), attr='llas_to_cart', ctx=Load()), args=[Name(id='pos', ctx=Load()), Subscript(value=Name(id='pos', ctx=Load()), slice=Constant(value=0), ctx=Load())], keywords=[])), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[Name(id='t', ctx=Load()), Attribute(value=Name(id='T', ctx=Load()), attr='R', ctx=Load())], keywords=[]), generators=[comprehension(target=Tuple(elts=[Name(id='t', ctx=Store()), Name(id='T', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='zip', ctx=Load()), args=[Name(id='pos', ctx=Load()), Name(id='poses', ctx=Load())], keywords=[]), ifs=[], is_async=0)])], keywords=[]))], orelse=[]), Assign(targets=[Name(id='T_norm', ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[])), If(test=Name(id='normalize_ori', ctx=Load()), body=[Assign(targets=[Attribute(value=Name(id='T_norm', ctx=Load()), attr='R', ctx=Store())], value=Attribute(value=Subscript(value=Name(id='poses', ctx=Load()), slice=Constant(value=0), ctx=Load()), attr='R', ctx=Load()))], orelse=[]), If(test=Name(id='normalize_pos', ctx=Load()), body=[Assign(targets=[Attribute(value=Name(id='T_norm', ctx=Load()), attr='t', ctx=Store())], value=Attribute(value=Subscript(value=Name(id='poses', ctx=Load()), slice=Constant(value=0), ctx=Load()), attr='t', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=BinOp(left=Call(func=Attribute(value=Name(id='T_norm', ctx=Load()), attr='inv', ctx=Load()), args=[], keywords=[]), op=Mult(), right=Name(id='T', ctx=Load())), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='matrices', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Attribute(value=Name(id='T', ctx=Load()), attr='matrix', ctx=Load()), args=[], keywords=[]), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), If(test=Name(id='save_to_file', ctx=Load()), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='exists', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load())], keywords=[])), body=[Expr(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='makedirs', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load())], keywords=[]))], orelse=[]), With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Name(id='pickle_file', ctx=Load()), Constant(value='wb')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Expr(value=Call(func=Attribute(value=Name(id='pickle', ctx=Load()), attr='dump', ctx=Load()), args=[Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='matrices', ctx=Load())], ctx=Load()), Name(id='f', ctx=Load())], keywords=[]))])], orelse=[])]), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='RBT', ctx=Load()), attr='From_Matrix', ctx=Load()), args=[Name(id='matrices', ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='poses', ctx=Load())], ctx=Load()))], decorator_list=[])], type_ignores=[])", "args": ["r3", "/media/aaron/aaron_ssd/datasets/OKULAr/"], "kwargs": {}, "bin_id": 2}, {"ast": "Module(body=[FunctionDef(name='load_gt_poses', args=arguments(posonlyargs=[], args=[arg(arg='seq'), arg(arg='home_dir')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='/home/aaron/datasets/OKULAr')]), body=[Assign(targets=[Name(id='path', ctx=Store())], value=Call(func=Name(id='get_path', ctx=Load()), args=[Name(id='seq', ctx=Load()), Name(id='home_dir', ctx=Load())], keywords=[])), Return(value=Call(func=Name(id='_load_gt_poses', ctx=Load()), args=[Name(id='path', ctx=Load())], keywords=[]))], decorator_list=[Call(func=Name(id='persist', ctx=Load()), args=[], keywords=[keyword(arg='depth', value=Constant(value=3)), keyword(arg='verbose', value=Constant(value=True))])])], type_ignores=[])Module(body=[FunctionDef(name='persist', args=arguments(posonlyargs=[], args=[arg(arg='depth'), arg(arg='verbose')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value=0), Constant(value=False)]), body=[FunctionDef(name='_persist', args=arguments(posonlyargs=[], args=[arg(arg='func')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='wrapper', args=arguments(posonlyargs=[], args=[], vararg=arg(arg='args'), kwonlyargs=[], kw_defaults=[], kwarg=arg(arg='kwargs'), defaults=[]), body=[Assign(targets=[Name(id='function_call', ctx=Store())], value=Call(func=Name(id='Function_Call', ctx=Load()), args=[Name(id='func', ctx=Load()), Name(id='args', ctx=Load()), Name(id='kwargs', ctx=Load()), Constant(value=1)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='success', ctx=Store()), Name(id='persisted_result', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='function_call', ctx=Load()), attr='Load_Results', ctx=Load()), args=[], keywords=[])), If(test=Name(id='success', ctx=Load()), body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[JoinedStr(values=[Constant(value='Successfully loaded results for:'), FormattedValue(value=Name(id='func', ctx=Load()), conversion=-1)])], keywords=[])), Return(value=Name(id='persisted_result', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='result', ctx=Store())], value=Call(func=Name(id='func', ctx=Load()), args=[Starred(value=Name(id='args', ctx=Load()), ctx=Load())], keywords=[keyword(value=Name(id='kwargs', ctx=Load()))])), Expr(value=Call(func=Attribute(value=Name(id='function_call', ctx=Load()), attr='Save_Results', ctx=Load()), args=[Name(id='result', ctx=Load())], keywords=[])), Expr(value=Call(func=Name(id='print', ctx=Load()), args=[JoinedStr(values=[Constant(value='Successfully saved results for:'), FormattedValue(value=Name(id='func', ctx=Load()), conversion=-1)])], keywords=[])), Return(value=Name(id='result', ctx=Load()))], decorator_list=[]), Return(value=Name(id='wrapper', ctx=Load()))], decorator_list=[]), Return(value=Name(id='_persist', ctx=Load()))], decorator_list=[])], type_ignores=[])Module(body=[FunctionDef(name='get_path', args=arguments(posonlyargs=[], args=[arg(arg='seq'), arg(arg='home_dir')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='path', ctx=Store())], value=Call(func=Attribute(value=Name(id='glob', ctx=Load()), attr='glob', ctx=Load()), args=[BinOp(left=Name(id='home_dir', ctx=Load()), op=Add(), right=JoinedStr(values=[Constant(value='/*/'), FormattedValue(value=Name(id='seq', ctx=Load()), conversion=-1), Constant(value='/'), FormattedValue(value=Name(id='seq', ctx=Load()), conversion=-1), Constant(value='.mcap')]))], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='path', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]), msg=Constant(value='sequence not found or ambiguous')), Return(value=Subscript(value=Name(id='path', ctx=Load()), slice=Constant(value=0), ctx=Load()))], decorator_list=[])], type_ignores=[])Module(body=[FunctionDef(name='_load_gt_poses', args=arguments(posonlyargs=[], args=[arg(arg='bagfile'), arg(arg='navsat_topic'), arg(arg='imu_topic'), arg(arg='normalize_ori'), arg(arg='normalize_pos'), arg(arg='cart_pos'), arg(arg='try_quickload'), arg(arg='save_to_file')], kwonlyargs=[], kw_defaults=[], defaults=[Constant(value='/ref_sys/NavSatFix_INS'), Constant(value='/ref_sys/inat_imu'), Constant(value=True), Constant(value=True), Constant(value=True), Constant(value=True), Constant(value=True)]), body=[FunctionDef(name='calc_poses_from_pos_and_ori', args=arguments(posonlyargs=[], args=[arg(arg='timestamps'), arg(arg='pos_ts'), arg(arg='pos'), arg(arg='ori_ts'), arg(arg='ori')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Tuple(elts=[Name(id='_', ctx=Store()), Name(id='pos', ctx=Store())], ctx=Store())], value=Call(func=Name(id='interpolate_poses_linear', ctx=Load()), args=[Name(id='timestamps', ctx=Load()), Name(id='pos_ts', ctx=Load()), Name(id='pos', ctx=Load())], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='_', ctx=Store()), Name(id='ori', ctx=Store())], ctx=Store())], value=Call(func=Name(id='interpolate_poses_linear', ctx=Load()), args=[Name(id='timestamps', ctx=Load()), Name(id='ori_ts', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[])), Assert(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='pos', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Call(func=Name(id='len', ctx=Load()), args=[Name(id='ori', ctx=Load())], keywords=[])])), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[Attribute(value=Name(id='p', ctx=Load()), attr='t', ctx=Load()), Attribute(value=Name(id='o', ctx=Load()), attr='R', ctx=Load())], keywords=[]), generators=[comprehension(target=Tuple(elts=[Name(id='p', ctx=Store()), Name(id='o', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='zip', ctx=Load()), args=[Name(id='pos', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[]), ifs=[], is_async=0)])], keywords=[])), Return(value=Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='poses', ctx=Load())], ctx=Load()))], decorator_list=[]), FunctionDef(name='interpolate_poses_linear', args=arguments(posonlyargs=[], args=[arg(arg='timestamps'), arg(arg='timestamps_poses'), arg(arg='poses')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[FunctionDef(name='get_idk', args=arguments(posonlyargs=[], args=[arg(arg='list'), arg(arg='element')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=[Assign(targets=[Name(id='greater', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='greater_equal', ctx=Load()), args=[Name(id='list', ctx=Load()), Name(id='element', ctx=Load())], keywords=[])), Assign(targets=[Name(id='first_greater', ctx=Store())], value=Subscript(value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='nonzero', ctx=Load()), args=[Name(id='greater', ctx=Load())], keywords=[]), slice=Constant(value=0), ctx=Load()), slice=Constant(value=0), ctx=Load())), Assign(targets=[Name(id='less', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='less_equal', ctx=Load()), args=[Name(id='list', ctx=Load()), Name(id='element', ctx=Load())], keywords=[])), Assign(targets=[Name(id='last_less', ctx=Store())], value=Subscript(value=Subscript(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='nonzero', ctx=Load()), args=[Name(id='less', ctx=Load())], keywords=[]), slice=Constant(value=0), ctx=Load()), slice=UnaryOp(op=USub(), operand=Constant(value=1)), ctx=Load())), Return(value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='arange', ctx=Load()), args=[Name(id='last_less', ctx=Load()), BinOp(left=Name(id='first_greater', ctx=Load()), op=Add(), right=Constant(value=1)), Constant(value=1), Name(id='int', ctx=Load())], keywords=[]))], decorator_list=[]), Assign(targets=[Name(id='Ts', ctx=Store())], value=List(elts=[], ctx=Load())), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='t', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='timestamps', ctx=Load())], keywords=[]), body=[Try(body=[Assign(targets=[Name(id='inds', ctx=Store())], value=Call(func=Name(id='get_idk', ctx=Load()), args=[Name(id='timestamps_poses', ctx=Load()), Name(id='t', ctx=Load())], keywords=[]))], handlers=[ExceptHandler(type=Name(id='IndexError', ctx=Load()), name='e', body=[Expr(value=Call(func=Name(id='print', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[])), Continue()])], orelse=[], finalbody=[]), If(test=Compare(left=Call(func=Name(id='len', ctx=Load()), args=[Name(id='inds', ctx=Load())], keywords=[]), ops=[Eq()], comparators=[Constant(value=1)]), body=[Expr(value=Call(func=Attribute(value=Name(id='Ts', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='i', ctx=Load()), Subscript(value=Name(id='poses', ctx=Load()), slice=Subscript(value=Name(id='inds', ctx=Load()), slice=Constant(value=0), ctx=Load()), ctx=Load())], ctx=Load())], keywords=[]))], orelse=[Assign(targets=[Tuple(elts=[Name(id='pose_1', ctx=Store()), Name(id='pose_2', ctx=Store())], ctx=Store())], value=Subscript(value=Name(id='poses', ctx=Load()), slice=Name(id='inds', ctx=Load()), ctx=Load())), Assign(targets=[Tuple(elts=[Name(id='time_1', ctx=Store()), Name(id='time_2', ctx=Store())], ctx=Store())], value=Subscript(value=Name(id='timestamps_poses', ctx=Load()), slice=Name(id='inds', ctx=Load()), ctx=Load())), Assign(targets=[Name(id='dt2', ctx=Store())], value=BinOp(left=Name(id='time_2', ctx=Load()), op=Sub(), right=Name(id='time_1', ctx=Load()))), Assign(targets=[Name(id='dt', ctx=Store())], value=BinOp(left=Name(id='t', ctx=Load()), op=Sub(), right=Name(id='time_1', ctx=Load()))), Assign(targets=[Name(id='f', ctx=Store())], value=BinOp(left=Name(id='dt', ctx=Load()), op=Div(), right=Name(id='dt2', ctx=Load()))), Assert(test=BoolOp(op=And(), values=[Compare(left=Name(id='f', ctx=Load()), ops=[GtE()], comparators=[Constant(value=0)]), Compare(left=Name(id='f', ctx=Load()), ops=[LtE()], comparators=[Constant(value=1)])])), Assign(targets=[Name(id='pose', ctx=Store())], value=BinOp(left=BinOp(left=BinOp(left=Constant(value=1), op=Sub(), right=Name(id='f', ctx=Load())), op=Mult(), right=Call(func=Attribute(value=Name(id='pose_1', ctx=Load()), attr='log', ctx=Load()), args=[], keywords=[])), op=Add(), right=BinOp(left=Name(id='f', ctx=Load()), op=Mult(), right=Call(func=Attribute(value=Name(id='pose_2', ctx=Load()), attr='log', ctx=Load()), args=[], keywords=[])))), Assign(targets=[Name(id='pose', ctx=Store())], value=Call(func=Attribute(value=Name(id='SE3', ctx=Load()), attr='exp', ctx=Load()), args=[Name(id='pose', ctx=Load())], keywords=[])), Expr(value=Call(func=Attribute(value=Name(id='Ts', ctx=Load()), attr='append', ctx=Load()), args=[Tuple(elts=[Name(id='i', ctx=Load()), Name(id='pose', ctx=Load())], ctx=Load())], keywords=[]))])], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='indices', ctx=Store()), Name(id='poses', ctx=Store())], ctx=Store())], value=Call(func=Name(id='zip', ctx=Load()), args=[Starred(value=Name(id='Ts', ctx=Load()), ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[Name(id='indices', ctx=Load())], keywords=[]), Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[Name(id='poses', ctx=Load())], keywords=[])], ctx=Load()))], decorator_list=[]), If(test=BoolOp(op=Or(), values=[Name(id='try_quickload', ctx=Load()), Name(id='save_to_file', ctx=Load())]), body=[Assign(targets=[Name(id='bytes_s', ctx=Store())], value=ListComp(elt=Call(func=Attribute(value=Name(id='dill', ctx=Load()), attr='dumps', ctx=Load()), args=[Name(id='e', ctx=Load())], keywords=[]), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=List(elts=[Name(id='bagfile', ctx=Load()), Name(id='navsat_topic', ctx=Load()), Name(id='imu_topic', ctx=Load()), Name(id='normalize_ori', ctx=Load()), Name(id='normalize_pos', ctx=Load()), Name(id='cart_pos', ctx=Load())], ctx=Load()), ifs=[], is_async=0)])), Assign(targets=[Name(id='bytes', ctx=Store())], value=Call(func=Attribute(value=Name(id='functools', ctx=Load()), attr='reduce', ctx=Load()), args=[Lambda(args=arguments(posonlyargs=[], args=[arg(arg='a'), arg(arg='b')], kwonlyargs=[], kw_defaults=[], defaults=[]), body=BinOp(left=Name(id='a', ctx=Load()), op=Add(), right=Name(id='b', ctx=Load()))), Name(id='bytes_s', ctx=Load())], keywords=[])), Assign(targets=[Name(id='hash', ctx=Store())], value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='hashlib', ctx=Load()), attr='sha1', ctx=Load()), args=[Name(id='bytes', ctx=Load())], keywords=[]), attr='hexdigest', ctx=Load()), args=[], keywords=[])), Assign(targets=[Name(id='bagfile_dir', ctx=Store())], value=Attribute(value=Call(func=Attribute(value=Call(func=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), args=[Name(id='bagfile', ctx=Load())], keywords=[]), attr='resolve', ctx=Load()), args=[], keywords=[]), attr='parent', ctx=Load())), Assign(targets=[Name(id='pickle_dir', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='joinpath', ctx=Load()), args=[Name(id='bagfile_dir', ctx=Load()), Constant(value='pickles')], keywords=[])), Assign(targets=[Name(id='pickle_file', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='joinpath', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load()), Name(id='hash', ctx=Load())], keywords=[]))], orelse=[]), If(test=BoolOp(op=And(), values=[Name(id='try_quickload', ctx=Load()), Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='exists', ctx=Load()), args=[Name(id='pickle_file', ctx=Load())], keywords=[])]), body=[With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Name(id='pickle_file', ctx=Load()), Constant(value='rb')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Assign(targets=[Tuple(elts=[Name(id='timestamps', ctx=Store()), Name(id='matrices', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='pickle', ctx=Load()), attr='load', ctx=Load()), args=[Name(id='f', ctx=Load())], keywords=[]))])], orelse=[Assign(targets=[Name(id='T_correction', ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='R', value=Call(func=Attribute(value=Name(id='Rotation', ctx=Load()), attr='from_rotvec', ctx=Load()), args=[Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[List(elts=[Constant(value=0), Constant(value=0), BinOp(left=UnaryOp(op=USub(), operand=Attribute(value=Name(id='np', ctx=Load()), attr='pi', ctx=Load())), op=Div(), right=Constant(value=2))], ctx=Load())], keywords=[])], keywords=[]))])), Assign(targets=[Tuple(elts=[Name(id='timestamps_pos', ctx=Store()), Name(id='pos', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='abstract_reader', ctx=Load()), args=[Name(id='bagfile', ctx=Load()), Name(id='navsat_topic', ctx=Load()), Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='parse_navsatfix_msg', ctx=Load()), Constant(value=True), Constant(value=True)], keywords=[])), Assign(targets=[Tuple(elts=[Name(id='ori_timestamps', ctx=Store()), Name(id='ori', ctx=Store())], ctx=Store())], value=Call(func=Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='abstract_reader', ctx=Load()), args=[Name(id='bagfile', ctx=Load()), Name(id='imu_topic', ctx=Load()), Attribute(value=Name(id='dataloader_rosbag', ctx=Load()), attr='parse_imu_msg', ctx=Load()), Constant(value=True), Constant(value=True)], keywords=[])), Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='t', value=Name(id='e', ctx=Load()))]), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=Name(id='pos', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='ori', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=BinOp(left=Name(id='T_correction', ctx=Load()), op=Mult(), right=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[keyword(arg='R', value=Name(id='e', ctx=Load()))])), generators=[comprehension(target=Name(id='e', ctx=Store()), iter=Name(id='ori', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), For(target=Tuple(elts=[Name(id='i', ctx=Store()), Name(id='T', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='enumerate', ctx=Load()), args=[Name(id='ori', ctx=Load())], keywords=[]), body=[Assign(targets=[Name(id='euler', ctx=Store())], value=Call(func=Attribute(value=Attribute(value=Name(id='T', ctx=Load()), attr='R', ctx=Load()), attr='as_euler', ctx=Load()), args=[Constant(value='XYZ')], keywords=[])), AugAssign(target=Subscript(value=Name(id='euler', ctx=Load()), slice=Slice(lower=Constant(value=1)), ctx=Store()), op=Mult(), value=UnaryOp(op=USub(), operand=Constant(value=1))), Assign(targets=[Subscript(value=Name(id='ori', ctx=Load()), slice=Name(id='i', ctx=Load()), ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[Attribute(value=Name(id='T', ctx=Load()), attr='t', ctx=Load()), Call(func=Attribute(value=Name(id='Rotation', ctx=Load()), attr='from_euler', ctx=Load()), args=[Constant(value='XYZ'), Name(id='euler', ctx=Load())], keywords=[])], keywords=[]))], orelse=[]), Assign(targets=[Tuple(elts=[Name(id='timestamps', ctx=Store()), Name(id='poses', ctx=Store())], ctx=Store())], value=Call(func=Name(id='calc_poses_from_pos_and_ori', ctx=Load()), args=[Name(id='timestamps_pos', ctx=Load()), Name(id='timestamps_pos', ctx=Load()), Name(id='pos', ctx=Load()), Name(id='ori_timestamps', ctx=Load()), Name(id='ori', ctx=Load())], keywords=[])), Assert(test=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='all', ctx=Load()), args=[Compare(left=Name(id='timestamps', ctx=Load()), ops=[Eq()], comparators=[Name(id='timestamps_pos', ctx=Load())])], keywords=[])), If(test=Name(id='cart_pos', ctx=Load()), body=[Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Attribute(value=Name(id='T', ctx=Load()), attr='t', ctx=Load()), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='pos', ctx=Store())], value=Call(func=Attribute(value=Name(id='util', ctx=Load()), attr='llas_to_cart', ctx=Load()), args=[Name(id='pos', ctx=Load()), Subscript(value=Name(id='pos', ctx=Load()), slice=Constant(value=0), ctx=Load())], keywords=[])), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Name(id='SE3', ctx=Load()), args=[Name(id='t', ctx=Load()), Attribute(value=Name(id='T', ctx=Load()), attr='R', ctx=Load())], keywords=[]), generators=[comprehension(target=Tuple(elts=[Name(id='t', ctx=Store()), Name(id='T', ctx=Store())], ctx=Store()), iter=Call(func=Name(id='zip', ctx=Load()), args=[Name(id='pos', ctx=Load()), Name(id='poses', ctx=Load())], keywords=[]), ifs=[], is_async=0)])], keywords=[]))], orelse=[]), Assign(targets=[Name(id='T_norm', ctx=Store())], value=Call(func=Name(id='SE3', ctx=Load()), args=[], keywords=[])), If(test=Name(id='normalize_ori', ctx=Load()), body=[Assign(targets=[Attribute(value=Name(id='T_norm', ctx=Load()), attr='R', ctx=Store())], value=Attribute(value=Subscript(value=Name(id='poses', ctx=Load()), slice=Constant(value=0), ctx=Load()), attr='R', ctx=Load()))], orelse=[]), If(test=Name(id='normalize_pos', ctx=Load()), body=[Assign(targets=[Attribute(value=Name(id='T_norm', ctx=Load()), attr='t', ctx=Store())], value=Attribute(value=Subscript(value=Name(id='poses', ctx=Load()), slice=Constant(value=0), ctx=Load()), attr='t', ctx=Load()))], orelse=[]), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=BinOp(left=Call(func=Attribute(value=Name(id='T_norm', ctx=Load()), attr='inv', ctx=Load()), args=[], keywords=[]), op=Mult(), right=Name(id='T', ctx=Load())), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), Assign(targets=[Name(id='matrices', ctx=Store())], value=Call(func=Attribute(value=Name(id='np', ctx=Load()), attr='array', ctx=Load()), args=[ListComp(elt=Call(func=Attribute(value=Name(id='T', ctx=Load()), attr='matrix', ctx=Load()), args=[], keywords=[]), generators=[comprehension(target=Name(id='T', ctx=Store()), iter=Name(id='poses', ctx=Load()), ifs=[], is_async=0)])], keywords=[])), If(test=Name(id='save_to_file', ctx=Load()), body=[If(test=UnaryOp(op=Not(), operand=Call(func=Attribute(value=Attribute(value=Name(id='pathlib', ctx=Load()), attr='Path', ctx=Load()), attr='exists', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load())], keywords=[])), body=[Expr(value=Call(func=Attribute(value=Name(id='os', ctx=Load()), attr='makedirs', ctx=Load()), args=[Name(id='pickle_dir', ctx=Load())], keywords=[]))], orelse=[]), With(items=[withitem(context_expr=Call(func=Name(id='open', ctx=Load()), args=[Name(id='pickle_file', ctx=Load()), Constant(value='wb')], keywords=[]), optional_vars=Name(id='f', ctx=Store()))], body=[Expr(value=Call(func=Attribute(value=Name(id='pickle', ctx=Load()), attr='dump', ctx=Load()), args=[Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='matrices', ctx=Load())], ctx=Load()), Name(id='f', ctx=Load())], keywords=[]))])], orelse=[])]), Assign(targets=[Name(id='poses', ctx=Store())], value=Call(func=Attribute(value=Name(id='RBT', ctx=Load()), attr='From_Matrix', ctx=Load()), args=[Name(id='matrices', ctx=Load())], keywords=[])), Return(value=Tuple(elts=[Name(id='timestamps', ctx=Load()), Name(id='poses', ctx=Load())], ctx=Load()))], decorator_list=[])], type_ignores=[])", "args": ["b4", "/media/aaron/aaron_ssd/datasets/OKULAr/"], "kwargs": {}, "bin_id": 3}]